<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ai-Connect - Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="icon" href="assets/logo/logo.png" type="image/png"> <!-- ai-Connect Favicon -->
  <meta name="theme-color" content="#0d0d1a">

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Roboto+Mono:wght@400;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
  
  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script> <!-- Using Realtime Database -->
  
  <!-- Tailwind (from original, can be removed if all styling is custom) -->
  <!-- <script src="https://cdn.tailwindcss.com"></script> -->

  <style>
    :root {
      /* ai-Connect Neon-Dark Theme Variables */
      --aiConnect-bg-dark: #0d0d1a;
      --aiConnect-panel-dark: #121225;
      --aiConnect-glass-bg: rgba(18, 18, 37, 0.85);
      --aiConnect-border: rgba(0, 255, 255, 0.25);
      --aiConnect-cyan: #00ffff;
      --aiConnect-cyan-dark: #00cccc;
      --aiConnect-glow-soft: rgba(0, 255, 255, 0.2);
      --aiConnect-glow-medium: rgba(0, 255, 255, 0.4);
      --aiConnect-gold: #ffc107; /* For wallet card or accents */
      --aiConnect-text-primary: #e0e0f0;
      --aiConnect-text-secondary: #a0a0c0;
      --aiConnect-success: #00ff88;
      --aiConnect-error: #ff4444;

      --font-display: 'Orbitron', sans-serif;
      --font-body: 'Roboto Mono', monospace;

      --spacing-unit: 15px;
      --border-radius: 8px;
      --border-radius-large: 12px;
      --card-shadow: 0 0 15px var(--aiConnect-glow-soft); /* Default card shadow */
      --transition-speed: 0.25s;
      
      /* Layout specific to this combined structure */
      --sidebar-width: 250px; 
      --sidebar-width-collapsed: 60px; 
      --topbar-height: 56px; /* Consistent with ai-Connect header */
      --card-padding: var(--spacing-unit); 

      /* Font Sizes (can adjust to match ai-Connect's preferred scale) */
      --font-size-base: 0.875rem; /* 14px */    
      --font-size-small: 0.75rem; /* 12px */    
      --font-size-medium: 0.875rem; /* 14px */  
      --font-size-large: 1rem; /* 16px */    
      --font-size-xl: 1.2rem; /* ~19px */     
      --font-size-card-description: 0.8rem; 
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    
    html {
        font-size: 16px; /* Base for rem units */
        scroll-behavior: smooth;
    }
    body {
        font-family: var(--font-body); 
        background-color: var(--aiConnect-bg-dark); 
        color: var(--aiConnect-text-primary);
        line-height: 1.6; 
        font-size: var(--font-size-base);
        transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
        overflow-x: hidden; /* Prevent horizontal scroll on body */
        display: flex; /* For centering .app-container on wider screens */
        justify-content: center;
    }
    a { text-decoration: none; color: var(--aiConnect-cyan); transition: color var(--transition-speed) ease; }
    a:hover { text-decoration: underline; color: var(--aiConnect-cyan-dark); }
    ul { list-style: none; }
    img { max-width: 100%; height: auto; display: block; }
    button { 
        font-family: inherit; cursor: pointer; border: none; 
        border-radius: var(--border-radius); 
        transition: background-color var(--transition-speed), transform 0.1s, box-shadow var(--transition-speed); 
    }
    button:active { transform: translateY(1px) scale(0.98); }
    .material-symbols-outlined, .fas, .far { vertical-align: middle; line-height: 1; }


    .app-container { 
        display: flex; 
        min-height: 100vh; 
        min-height: 100dvh; /* Mobile viewport height */
        width: 100%;
        max-width: 420px; /* ai-Connect mobile-first width */
        background-color: var(--aiConnect-bg-dark);
        position: relative; /* For fixed/absolute children within this container */
        overflow: hidden; /* Clipping content to this container */
        border-left: 1px solid var(--aiConnect-border); /* Optional frame */
        border-right: 1px solid var(--aiConnect-border);
    }

    /* Sidebar */
    .sidebar {
        width: var(--sidebar-width); 
        background-color: var(--aiConnect-panel-dark); /* Use panel color */
        border-right: 1px solid var(--aiConnect-border); 
        position: fixed; top: 0; left: 0; height: 100%; height: 100dvh;
        padding: 0.7rem 0; 
        overflow-y: auto; 
        overflow-x: hidden;
        transition: transform var(--transition-speed) ease, width var(--transition-speed) ease; /* Changed from left to transform */
        transform: translateX(-100%); /* Hidden by default on mobile */
        z-index: 1000;
        box-shadow: 2px 0 15px rgba(0,0,0,0.3);
    }
    .sidebar.open { transform: translateX(0); }
    .sidebar::-webkit-scrollbar { width: 4px; }
    .sidebar::-webkit-scrollbar-thumb { background-color: var(--aiConnect-border); border-radius: 2px; }

    .sidebar-header {
        display: flex; align-items: center; padding: 0 var(--spacing-unit);
        border-bottom: 1px solid var(--aiConnect-border); margin-bottom: 0.7rem;
        min-height: var(--topbar-height); /* Match topbar height */
    }
    .sidebar-header .logo { height: 28px; width: auto; margin-right: 0.6rem; object-fit: contain; filter: drop-shadow(0 0 3px var(--aiConnect-cyan)); }
    .sidebar-header .app-title-sidebar {
        font-family: var(--font-display); font-size: 1rem; font-weight: 600;
        color: var(--aiConnect-cyan); white-space: nowrap; opacity: 1;
        text-shadow: 0 0 5px var(--aiConnect-glow-medium);
        transition: opacity var(--transition-speed) ease 0.1s;
    }

    .sidebar-nav ul { padding: 0 0.6rem; }
    .sidebar-nav .nav-heading {
        font-family: var(--font-display); font-size: var(--font-size-small); text-transform: uppercase; letter-spacing: 0.5px;
        color: var(--aiConnect-text-secondary); padding: 0.7rem 0.3rem 0.3rem;
        font-weight: 500; white-space: nowrap; opacity: 1;
    }
    .sidebar-nav li a {
        display: flex; align-items: center; padding: 0.6rem 0.5rem; /* Adjusted padding */
        color: var(--aiConnect-text-primary); border-radius: var(--border-radius); margin-bottom: 0.2rem;
        font-family: var(--font-body); font-size: var(--font-size-medium); font-weight: 500;
    }
    .sidebar-nav li a i.fas, .sidebar-nav li a i.far, .sidebar-nav li a .material-symbols-outlined { 
        font-size: 1rem; min-width: 20px; margin-right: 0.7rem; text-align: center;
        color: var(--aiConnect-text-secondary); /* Icon color */
    }
    .sidebar-nav li a:hover { background-color: rgba(0,255,255,0.08); color: var(--aiConnect-cyan); }
    .sidebar-nav li a:hover i, .sidebar-nav li a:hover .material-symbols-outlined { color: var(--aiConnect-cyan); }
    .sidebar-nav li a.active { background: var(--aiConnect-cyan); color: var(--aiConnect-bg-dark); }
    .sidebar-nav li a.active i, .sidebar-nav li a.active .material-symbols-outlined { color: var(--aiConnect-bg-dark); }

    /* Collapsed Sidebar (Desktop) - For future use if desktop layout is different */
    /* For mobile, sidebar is either open (transformX(0)) or closed (transformX(-100%)) */
    @media (min-width: 768px) { /* Apply collapsed styles for larger screens if sidebar starts collapsed */
        .sidebar.collapsed { width: var(--sidebar-width-collapsed); transform: translateX(0); }
        .sidebar.collapsed .sidebar-header { padding-left: 0; padding-right: 0; justify-content: center;}
        .sidebar.collapsed .sidebar-header .app-title-sidebar { opacity: 0; pointer-events: none; width: 0; }
        .sidebar.collapsed .sidebar-header .logo { margin-right: 0; height: 26px; }
        .sidebar.collapsed .sidebar-nav .nav-heading { opacity: 0; pointer-events: none; height: 0; padding: 0; margin: 0; }
        .sidebar.collapsed .sidebar-nav li a span { display: none; } /* Hide text span */
        .sidebar.collapsed .sidebar-nav li a { justify-content: center; padding: 0.6rem 0; }
        .sidebar.collapsed .sidebar-nav li a i, .sidebar.collapsed .sidebar-nav li a .material-symbols-outlined { margin-right: 0; font-size: 1.1rem; }
    }
            
    .main-wrapper { 
        flex-grow: 1; 
        /* margin-left: 0; /* Sidebar is overlay on mobile, no margin needed */
        display: flex; 
        flex-direction: column; 
        transition: margin-left var(--transition-speed) ease; 
        width: 100%; /* Ensure it takes full width of app-container */
    }
    @media (min-width: 768px) { /* Sidebar pushes content on larger screens */
        .main-wrapper { margin-left: var(--sidebar-width); }
        .sidebar.collapsed + .main-wrapper { margin-left: var(--sidebar-width-collapsed); }
        .sidebar { transform: translateX(0); } /* Sidebar visible by default on desktop */
    }


    /* Topbar */
    .topbar {
        height: var(--topbar-height); 
        background-color: var(--aiConnect-glass-bg); /* Use aiConnect glass */
        backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--aiConnect-border); 
        display: flex; align-items: center; justify-content: space-between;
        padding: 0 var(--spacing-unit); 
        position: sticky; top: 0; z-index: 90; /* Below sidebar */
        box-shadow: 0 1px 5px rgba(0,0,0,0.2), 0 0 8px var(--aiConnect-glow-soft);
    }
    .hamburger-btn {
        background: none; border: none; color: var(--aiConnect-cyan); font-size: 1.4rem; cursor: pointer;
        margin-right: 0.6rem; display: flex; align-items: center; justify-content: center;
        width: 38px; height: 38px; border-radius: 50%;
    }
    .hamburger-btn:hover { background-color: rgba(0, 255, 255, 0.1); }
    /* Hide hamburger on larger screens if sidebar is not collapsible by it */
    @media (min-width: 768px) { .hamburger-btn { display: none; } }
            
    .app-title-topbar { 
        font-family: var(--font-display); font-size: var(--font-size-xl); font-weight: 600; 
        color: var(--aiConnect-cyan); text-shadow: 0 0 5px var(--aiConnect-glow-medium);
    }
    .topbar-right { display: flex; align-items: center; gap: 0.6rem; }
    .btn-theme-toggle { /* aiConnect styled theme toggle */
        background: none; border: 1px solid var(--aiConnect-border); color: var(--aiConnect-cyan);
        font-size: 1.1rem; width: 36px; height: 36px; border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
    }
    .btn-theme-toggle:hover { background-color: rgba(0, 255, 255, 0.1); }
    .profile-menu .profile-icon-topbar { /* aiConnect styled profile icon */
         width: 36px; height: 36px; border-radius: 50%; cursor: pointer; 
         border: 1px solid var(--aiConnect-border);
         color: var(--aiConnect-text-secondary);
         display: flex; align-items: center; justify-content: center;
    }
    .profile-menu .profile-icon-topbar:hover { color: var(--aiConnect-cyan); background-color: rgba(0,255,255,0.08); }


    .content-area { flex-grow: 1; padding: var(--spacing-unit); overflow-y: auto; }
    .content-header { margin-bottom: var(--spacing-unit); }
    .content-header h2 { 
        font-family: var(--font-display); font-size: var(--font-size-large); 
        font-weight: 600; margin-bottom: 0.2rem; color: var(--aiConnect-cyan);
        text-shadow: 0 0 5px var(--aiConnect-glow-soft);
    }
    .content-header p { font-size: var(--font-size-base); color: var(--aiConnect-text-secondary); font-family: var(--font-body); }

    /* Wallet Card (Adapted for aiConnect) */
    .wallet-info-card {
      background: var(--aiConnect-panel-dark);
      color: var(--aiConnect-text-primary);
      border-radius: var(--border-radius-large); 
      padding: var(--card-padding);
      box-shadow: var(--card-shadow); 
      position: relative;
      overflow: hidden;
      margin-bottom: var(--spacing-unit); 
      border: 1px solid var(--aiConnect-border);
    }
    .wallet-info-card::before { /* Inner glow */
        content:''; position:absolute; top:0;left:0;right:0;bottom:0;
        border-radius:inherit; box-shadow: inset 0 0 10px rgba(0,255,255,0.1);
        pointer-events:none;
    }
    .wallet-info-card-header {
      display: flex; justify-content: space-between; align-items: flex-start;
      margin-bottom: var(--spacing-unit);
    }
    .wallet-info-card .user-info .user-name { 
        color: var(--aiConnect-text-primary); font-weight: 500; 
        font-size: 0.95rem; margin-bottom: 2px; font-family: var(--font-display);
    }
    .wallet-info-card .user-info .user-id { 
        color: var(--aiConnect-text-secondary); font-size: 0.7rem; opacity: 0.8; 
        font-family: var(--font-body);
    }
    .wallet-info-card .card-chip { /* Simple placeholder chip */
        width: 36px; height: 26px; 
        background: linear-gradient(135deg, var(--aiConnect-cyan-dark), var(--aiConnect-cyan));
        border-radius: 4px; margin-top: 2px;
        border: 1px solid rgba(0,0,0,0.2);
    }
    .wallet-info-card .balance-details { 
      display: flex; justify-content: space-around; align-items: flex-start;
      margin-bottom: var(--spacing-unit); gap: 0.5rem;
    }
    .wallet-info-card .balance-source { flex: 1; padding: 0 0.25rem; text-align: center; }
    .wallet-info-card .balance-details .balance-amount { 
      color: var(--aiConnect-text-primary); font-size: 1.4rem; /* Adjusted */
      font-weight: 700; font-family: var(--font-display);
      letter-spacing: -0.5px; margin-bottom: 2px;
    }
    .wallet-info-card .balance-details .balance-amount#unilevelIncome { color: var(--aiConnect-gold); } /* PHP balance in gold */
    .wallet-info-card .balance-details .balance-amount#tokenBalance { color: var(--aiConnect-cyan); } /* EMX in cyan */

    .wallet-info-card .balance-details .balance-label { 
      color: var(--aiConnect-text-secondary); font-size: 0.65rem; text-transform: uppercase;
      letter-spacing: 0.5px; opacity: 0.9; font-family: var(--font-body);
    }
    .wallet-info-card .wallet-actions { display: flex; gap: 0.7rem; }
    .wallet-info-card .wallet-actions .action-button {
      background-color: rgba(0, 255, 255, 0.1);
      color: var(--aiConnect-cyan);
      border: 1px solid var(--aiConnect-border);
      font-weight: 500; padding: 0.5rem 0.9rem; border-radius: var(--border-radius);
      flex: 1; display: flex; align-items: center; justify-content: center;
      gap: 6px; font-size: 0.8rem; font-family: var(--font-display);
    }
    .wallet-info-card .wallet-actions .action-button:hover { 
        background-color: rgba(0, 255, 255, 0.18); 
        border-color: var(--aiConnect-cyan); 
        box-shadow: 0 0 8px var(--aiConnect-glow-soft);
    }
    .wallet-info-card .wallet-actions .action-button .material-symbols-outlined {
        font-size: 1.1rem;
    }


    /* Tool Grid (Adapted for aiConnect) */
    .weconnect-tool-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: var(--spacing-unit); }
    .weconnect-tool-card {
        background-color: var(--aiConnect-panel-dark); 
        border-radius: var(--border-radius-large);
        padding: var(--card-padding); 
        box-shadow: var(--card-shadow);
        border: 1px solid var(--aiConnect-border); 
        position: relative;
        transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease, border-color var(--transition-speed) ease;
    }
    .weconnect-tool-card:hover { 
        transform: translateY(-3px); 
        border-color: var(--aiConnect-cyan); 
        box-shadow: 0 0 15px var(--aiConnect-glow-medium); 
    }

    .weconnect-tool-card-header { display: flex; align-items: center; margin-bottom: 0.6rem; }
    .weconnect-tool-card-header i.fas { font-size: 0.9rem; color: var(--aiConnect-cyan); margin-right: 0.6rem; }
    .weconnect-tool-card h3 { 
        font-family: var(--font-display); font-size: var(--font-size-medium); font-weight: 600;
        color: var(--aiConnect-text-primary); margin: 0; 
    }
    .weconnect-tool-card p { 
        font-family: var(--font-body); font-size: var(--font-size-card-description); color: var(--aiConnect-text-secondary);
        margin-bottom: 0.7rem; line-height: 1.5;
        min-height: 3em; 
    }
    .weconnect-tool-card .btn-launch { 
        display: inline-block; background-color: var(--aiConnect-cyan); color: var(--aiConnect-bg-dark);
        padding: 0.4rem 0.8rem; border-radius: var(--border-radius); text-align: center;
        font-family: var(--font-display); font-size: 0.75rem; font-weight: 600;
    }
    .weconnect-tool-card .btn-launch:hover { background-color: var(--aiConnect-cyan-dark); }


    .trending-tag { /* For "Trending" on tool cards */
        position: absolute; top: 0.6rem; right: 0.6rem; 
        background-color: var(--aiConnect-gold); /* Using gold for trending */
        color: var(--aiConnect-bg-dark); 
        padding: 0.2rem 0.4rem;
        font-weight: 600; font-family: var(--font-display); border-radius: 4px; text-transform: uppercase;
        font-size: 0.6rem; letter-spacing: 0.5px;
        box-shadow: 0 0 5px var(--aiConnect-gold-glow);
    }

    /* Loading Spinner */
    #pageLoading { /* ... (Using aiConnect standard loader styles from other pages) ... */ }
    /* Ensure spinner styles are present if using the #pageLoading div */
    #pageLoading {position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(13,17,23,0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1001; transition: opacity .3s ease,visibility .3s ease;}
    #pageLoading.hidden{opacity:0;visibility:hidden}
    #pageLoading .loading-text{font-family:var(--font-display);font-size:1rem; color: var(--aiConnect-text-primary);}
    #pageLoading .spinner{width:30px;height:30px;border:4px solid var(--aiConnect-border);border-top:4px solid var(--aiConnect-cyan);border-radius:50%;animation:spin .8s linear infinite;margin-bottom:14px; box-shadow: 0 0 8px var(--aiConnect-glow-soft);}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}


    /* --- AI Creator Tool Specific Styles (Adapted for aiConnect) --- */
    #aiToolContentContainer .ai-tool-wrapper-card { 
        background-color: var(--aiConnect-panel-dark); 
        border: 1px solid var(--aiConnect-border);
        border-radius: var(--border-radius-large);
        padding: 1.5rem; 
        margin-bottom: 1.5rem; 
        box-shadow: var(--card-shadow);
    }
    #aiToolContentContainer .ai-tool-wrapper-card h3 { 
        font-size: 1.2rem; 
        font-weight: 600; 
        margin-bottom: 1rem; 
        color: var(--aiConnect-cyan); 
        font-family: var(--font-display);
    }
    #aiToolContentContainer .ai-tool-wrapper-card label {
        display: block; margin-bottom: 0.5rem; 
        font-weight: 500; color: var(--aiConnect-text-secondary);
        font-size: 0.8rem;
    }
    /* General input styling for AI tools */
    #aiToolContentContainer input[type="text"],
    #aiToolContentContainer input[type="file"],
    #aiToolContentContainer textarea,
    #aiToolContentContainer select {
        background-color: var(--aiConnect-bg-dark); /* Darker input bg */
        color: var(--aiConnect-text-primary);
        border: 1px solid var(--aiConnect-border);
        border-radius: var(--border-radius);
        padding: 0.75rem; /* Tailwind p-2.5 or p-3 */
        width: 100%;
        font-size: 0.875rem; /* Tailwind text-sm */
        margin-bottom: 0.75rem; /* Consistent spacing */
    }
    #aiToolContentContainer input[type="text"]:focus,
    #aiToolContentContainer textarea:focus,
    #aiToolContentContainer select:focus {
        border-color: var(--aiConnect-cyan);
        outline: none;
        box-shadow: 0 0 8px var(--aiConnect-glow-soft);
    }
    #aiToolContentContainer button { /* AI Tool Action Buttons */
        background-color: var(--aiConnect-cyan);
        color: var(--aiConnect-bg-dark);
        font-family: var(--font-display);
        font-weight: 600;
        padding: 0.65rem 1.25rem; /* Tailwind px-5 py-2.5 */
        border-radius: var(--border-radius);
        margin-top: 1rem;
    }
    #aiToolContentContainer button:hover {
        background-color: var(--aiConnect-cyan-dark);
    }
    
    #aiToolContentContainer .output { 
        margin-top: 1rem; padding: 1rem; 
        background-color: rgba(0, 255, 255, 0.03); 
        border: 1px solid rgba(0, 255, 255, 0.1);
        border-radius: var(--border-radius); 
        white-space: pre-wrap; word-wrap: break-word;
        color: var(--aiConnect-text-primary);
        font-size: 0.85rem;
    }
    #aiToolContentContainer .output img {
        max-width: 100%; height: auto; border-radius: var(--border-radius);
        margin-top: 0.5rem; border: 1px solid var(--aiConnect-border);
    }
    #aiToolContentContainer .output audio { width: 100%; margin-top: 0.5rem; filter: invert(1) hue-rotate(180deg) contrast(0.8); } /* Invert audio player for dark theme */
    
    #aiToolContentContainer .spinner { /* AI Tool Spinner */
        border: 4px solid var(--aiConnect-border);
        width: 36px; height: 36px; border-radius: 50%;
        border-left-color: var(--aiConnect-cyan); 
        animation: spin 1s ease infinite;
        margin: 1rem auto; display: none; 
    }
    #apiKeyNotice {
        background-color: rgba(255, 193, 7, 0.1); /* Goldish warning */
        border-color: var(--aiConnect-gold);
    }
     #apiKeyNotice h3 { color: var(--aiConnect-gold); }
     #apiKeyNotice p { color: var(--aiConnect-text-secondary); font-size: 0.8rem;}


    @media (max-width: 767px) { /* Mobile responsiveness */
        .sidebar { transform: translateX(-100%); width: var(--sidebar-width); /* Full width when open */ }
        .sidebar.open { transform: translateX(0); box-shadow: 2px 0 15px rgba(0, 255, 255, 0.1); }
        .main-wrapper { margin-left: 0 !important; } /* Sidebar overlays on mobile */
        .app-title-topbar { display: none; } /* Hide topbar title on mobile if hamburger is present */
        .content-area { padding: var(--spacing-unit); }
        .weconnect-tool-grid { grid-template-columns: 1fr; gap: var(--spacing-unit); }
        .topbar { padding: 0 var(--spacing-unit); }
        #aiToolContentContainer .ai-tool-wrapper-card { padding: var(--spacing-unit); }
    }
  </style>
</head>
<body>
    <div id="pageLoading">
        <div class="spinner"></div>
        <p class="loading-text">Loading aiConnect...</p>
    </div>
    <div class="app-container">
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="assets/logo/logo.png" alt="ai-Connect Logo" class="logo"> 
            <span class="app-title-sidebar">ai-Connect</span>
        </div>
        <nav class="sidebar-nav">
            <ul>
                <li class="nav-heading">Main</li>
                <li><a href="#" class="main-nav-link active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a></li>
                <li><a href="#" class="main-nav-link" data-section="all-weconnect-tools"><i class="fas fa-th-large"></i><span>Platform Tools</span></a></li>
                <!-- <li><a href="#" class="main-nav-link" data-section="favorites"><i class="fas fa-star"></i><span>Favorites</span></a></li> -->

                <li class="nav-heading" id="aiCreatorSuiteNavHeader">AI Creator Suite</li>
                <div id="aiCreatorSuiteNavLinks">
                    <!-- AI Creator Suite links will be populated by JavaScript -->
                </div>

                <li class="nav-heading">User</li>
                <li><a href="aiconnect-userprofile.html" class="main-nav-link" data-section="profile"><i class="fas fa-user-circle"></i><span>My Profile</span></a></li>
                <li><a href="aiconnect-settings.html" class="main-nav-link" data-section="settings"><i class="fas fa-cog"></i><span>Settings</span></a></li>
                <li><a href="aiconnect-support.html" class="main-nav-link" data-section="support"><i class="fas fa-life-ring"></i><span>Support</span></a></li>
                <li><a href="#" id="signOutLinkSidebar"><i class="fas fa-sign-out-alt"></i><span>Logout</span></a></li>
            </ul>
        </nav>
    </aside>

    <div class="main-wrapper">
        <header class="topbar">
            <div class="topbar-left">
                <button class="hamburger-btn" id="hamburgerBtn" aria-label="Toggle Menu">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="app-title-topbar">Dashboard</h1> <!-- This can be dynamic -->
            </div>
            <div class="topbar-right">
                <!-- <button class="btn btn-upgrade"><i class="fas fa-rocket"></i> <span>Upgrade</span></button> -->
                <button class="btn-theme-toggle" id="themeToggleBtn" aria-label="Toggle Theme" style="display:none;"> <!-- Hide theme toggle for now -->
                    <i class="fas fa-moon"></i>
                </button>
                <div class="profile-menu">
                     <span class="material-symbols-outlined profile-icon-topbar" id="profileMenuIcon" title="Profile Options">account_circle</span>
                </div>
            </div>
        </header>

        <main class="content-area">
            <!-- Wallet Card for ai-Connect -->
            <div class="wallet-info-card" id="walletCard">
              <div class="wallet-info-card-header">
                <div class="user-info">
                    <div class="user-name" id="userName">Welcome, Loading...</div>
                    <div class="user-id" id="memberId">ID: Loading...</div>
                </div>
                <div class="card-chip"></div>
              </div>
              <div class="balance-details">
                <div class="balance-source">
                  <div class="balance-amount" id="unilevelIncome">₱0.00</div>
                  <div class="balance-label">PHP Balance</div>
                </div>
                <div class="balance-source">
                   <div class="balance-amount" id="tokenBalance">0.00 EMX</div>
                   <div class="balance-label">EMX Token</div>
                </div>
              </div>
              <div class="wallet-actions">
                <button id="historyButton" class="action-button">
                    <span class="material-symbols-outlined">history</span>
                    History
                </button>
                <button id="connectWalletButton" class="action-button"> <!-- Renamed from connectButton -->
                    <span class="material-symbols-outlined">account_balance_wallet</span> <!-- More fitting icon -->
                    Wallet
                </button>
              </div>
            </div>

            <div class="content-header" id="mainContentHeader">
                <h2>Dashboard Tools</h2>
                <p>Explore our collection of AI-powered tools.</p>
            </div>
            <div class="weconnect-tool-grid" id="weconnectToolGrid">
                <!-- WeConnect "Platform Tool" cards will be dynamically inserted here -->
            </div>

            <!-- Container for AI Creator Suite Tools -->
            <div id="aiToolContentContainer" style="display: none;">
                 <div class="ai-tool-wrapper-card" id="currentAiToolWrapper">
                    <!-- Active AI Tool's HTML will be injected here -->
                 </div>
            </div>
            <div id="apiKeyNotice" class="ai-tool-wrapper-card" style="display:none;">
                <!-- API Key Notice Content -->
            </div>
        </main>
    </div>
</div>

<script>
    const firebaseConfig = { /* ... Your ai-Connect Firebase Config ... */ 
        apiKey: "AIzaSyDwldURmtljNpORmpGRacwXriPmQZjF6j8",
        authDomain: "daisy-n7g20a.firebaseapp.com",
        databaseURL: "https://daisy-n7g20a-default-rtdb.firebaseio.com",
        projectId: "daisy-n7g20a",
        storageBucket: "daisy-n7g20a.appspot.com",
        messagingSenderId: "225362605902",
        appId: "1:225362605902:web:d2551cc389e78c92c3d01f"
    };
    if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
    const authInstance = firebase.auth(); // Renamed from auth
    const rtDbInstance = firebase.database(); // Using Realtime Database

    // API Keys (WARNING: INSECURE for production. Move to backend.)
    const TOGETHER_API_KEY = "3b1c02603a0137c8c8b265ef1ed02c3e448c089a44f052ca6acf54210fa6b34c"; 
    const DEEPGRAM_API_KEY = "7fafa4b6f51e5c61a4b4d3895654178ee8602f7e"; 

    // DOM Elements
    const pageLoadingElement = document.getElementById('pageLoading');
    const sidebar = document.getElementById('sidebar');
    const hamburgerBtn = document.getElementById('hamburgerBtn');
    const mainWrapper = document.querySelector('.main-wrapper');
    const themeToggleBtn = document.getElementById('themeToggleBtn'); // Kept for theme logic, though hidden
    const userNameElement = document.getElementById('userName');
    const memberIdElement = document.getElementById('memberId');
    const walletBalanceElement = document.getElementById('unilevelIncome'); // ID from original wallet, maps to PHP
    const tokenBalanceDisplayElement = document.getElementById('tokenBalance');
    const historyButton = document.getElementById('historyButton');
    const connectWalletButton = document.getElementById('connectWalletButton'); // Corrected ID
    const signOutLinkSidebar = document.getElementById('signOutLinkSidebar');
    const profileMenuIcon = document.getElementById('profileMenuIcon');
    const weConnectToolGrid = document.getElementById('weconnectToolGrid');
    const aiToolContentContainer = document.getElementById('aiToolContentContainer');
    const currentAiToolWrapper = document.getElementById('currentAiToolWrapper');
    const mainContentHeader = document.getElementById('mainContentHeader');
    const apiKeyNotice = document.getElementById('apiKeyNotice');
    const appTitleTopbar = document.querySelector('.app-title-topbar');


    // --- Theme (aiConnect is dark by default, no toggle needed unless you add one) ---
    function applyAiConnectTheme() {
        // aiConnect is dark by default, so we ensure data-theme is not set or is "dark"
        document.documentElement.setAttribute('data-theme', 'dark'); // Force aiConnect dark theme
        console.log("aiConnect dark theme applied.");
    }
    // Apply aiConnect theme on load
    applyAiConnectTheme();
    if(themeToggleBtn) themeToggleBtn.style.display = 'none'; // Hide Aitek theme toggle

    // --- Sidebar Logic (Adapted for mobile overlay) ---
    function toggleSidebar() {
        if (!sidebar) return;
        sidebar.classList.toggle('open'); // For mobile overlay
        // For desktop, if you re-introduce collapsed state:
        // const isMobile = window.innerWidth <= 767;
        // if (!isMobile) sidebar.classList.toggle('collapsed');
    }
    if (hamburgerBtn) hamburgerBtn.addEventListener('click', toggleSidebar);
    document.addEventListener('click', function(event) {
        if (window.innerWidth <= 767 && sidebar && sidebar.classList.contains('open') && 
            !sidebar.contains(event.target) && hamburgerBtn && !hamburgerBtn.contains(event.target)) {
            sidebar.classList.remove('open');
        }
    });
     window.addEventListener('resize', () => { // Close mobile sidebar on resize to desktop
        if (window.innerWidth > 767 && sidebar && sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
        }
    });


    // --- Utility Functions (formatCurrency, formatToken from aiConnect) ---
    function formatCurrency(amount, includeSymbol = true, currency = '₱') { 
        const numericAmount = Number(amount) || 0;
        const formatted = numericAmount.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        return includeSymbol ? currency + formatted : formatted;
    }
    function formatToken(amount, decimals = 2, symbol = "EMX") {
        const numericAmount = Number(amount) || 0;
        return numericAmount.toLocaleString(undefined, {
            minimumFractionDigits: decimals,
            maximumFractionDigits: decimals
        }) + " " + symbol;
    }
    function fileToBase64(file) { /* ... same as original ... */ 
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });
    }


    // --- Firebase User Data for Wallet Card ---
    let userRecordKeyGlobal = null;
    let userDataListener = null;

    function updateWalletCardUI(userData) {
        if (!userData) {
            if(userNameElement) userNameElement.textContent = `Welcome, Guest`;
            if(memberIdElement) memberIdElement.textContent = `ID: Not Found`;
            if(walletBalanceElement) walletBalanceElement.textContent = formatCurrency(0); // PHP Balance
            if(tokenBalanceDisplayElement) tokenBalanceDisplayElement.textContent = formatToken(0); // EMX Token
            return;
        }
        const displayName = userData.phoneNumberFormatted || `User ${userRecordKeyGlobal ? userRecordKeyGlobal.slice(-4) : '...'}`;
        if(userNameElement) userNameElement.textContent = `${displayName}`;
        if(memberIdElement) memberIdElement.textContent = `ID: ${userData.phoneNumberE164 || userRecordKeyGlobal || '...'}`;
        if(walletBalanceElement) walletBalanceElement.textContent = formatCurrency(userData.php_balance || 0); 
        if(tokenBalanceDisplayElement) tokenBalanceDisplayElement.textContent = formatToken(userData.emx_token_balance || 0);
    }

    function listenToUserData(phoneKey) {
        if (!phoneKey) { updateWalletCardUI(null); return; }
        if (userDataListener && userRecordKeyGlobal) {
             rtDbInstance.ref(`users_info/${userRecordKeyGlobal}`).off('value', userDataListener);
        }
        userRecordKeyGlobal = phoneKey;
        const userSpecificDataRef = rtDbInstance.ref(`users_info/${phoneKey}`);
        userDataListener = userSpecificDataRef.on('value', (snapshot) => {
            updateWalletCardUI(snapshot.exists() ? snapshot.val() : null);
        }, (error) => {
            console.error("Error listening to user data:", error);
            updateWalletCardUI(null);
        });
    }

    async function fetchInitialUserData(user) {
        if (!user || !user.uid) {
            if(pageLoadingElement) pageLoadingElement.classList.add('hidden');
            window.location.href = 'signin.html'; return;
        }
        if(pageLoadingElement && pageLoadingElement.querySelector('.loading-text')) pageLoadingElement.querySelector('.loading-text').textContent = "Syncing Account...";

        try {
            const usersInfoRef = rtDbInstance.ref('users_info');
            const query = usersInfoRef.orderByChild('firebaseUid').equalTo(user.uid);
            const snapshot = await query.once('value');
            if (snapshot.exists()) {
                let tempKey = null;
                snapshot.forEach(child => { tempKey = child.key; return true; });
                if (tempKey) listenToUserData(tempKey);
                else throw new Error("User key not found.");
            } else { throw new Error("User profile not found."); }
        } catch (e) {
            console.error("Error fetching initial user data:", e);
            updateWalletCardUI(null); 
            if(pageLoadingElement && pageLoadingElement.querySelector('.loading-text')) pageLoadingElement.querySelector('.loading-text').textContent = "Error loading profile.";
        } finally {
             if(pageLoadingElement) setTimeout(() => pageLoadingElement.classList.add('hidden'), 500); // Delay hide for listener
        }
    }
    
    authInstance.onAuthStateChanged((user) => {
        if (pageLoadingElement) pageLoadingElement.classList.remove('hidden');
        if (user) {
            fetchInitialUserData(user);
        } else {
            if (userDataListener && userRecordKeyGlobal) {
                rtDbInstance.ref(`users_info/${userRecordKeyGlobal}`).off('value', userDataListener);
                userRecordKeyGlobal = null; userDataListener = null;
            }
            window.location.href = 'signin.html';
        }
    });

    // Wallet Card Button Actions
    if(historyButton) historyButton.addEventListener('click', () => window.location.href = 'aiconnect-transactions.html');
    if(connectWalletButton) connectWalletButton.addEventListener('click', () => window.location.href = 'aiconnect-wallet-connect.html');
    if(signOutLinkSidebar) signOutLinkSidebar.addEventListener('click', (e) => { e.preventDefault(); handleSignOut(); });
    if(profileMenuIcon) profileMenuIcon.addEventListener('click', () => window.location.href = 'aiconnect-userprofile.html');

    async function handleSignOut() { /* ... (same as original, ensure listener is detached) ... */
        if (confirm("Are you sure you want to sign out?")) {
            try {
                if(pageLoadingElement) pageLoadingElement.classList.remove('hidden');
                if(pageLoadingElement.querySelector('.loading-text')) pageLoadingElement.querySelector('.loading-text').textContent = 'Signing out...';
                if (userDataListener && userRecordKeyGlobal) {
                    rtDbInstance.ref(`users_info/${userRecordKeyGlobal}`).off('value', userDataListener);
                    console.log("Detached listener on signout for key:", userRecordKeyGlobal);
                }
                await authInstance.signOut(); // onAuthStateChanged will redirect
            } catch (error) {
                console.error("Error signing out:", error); alert("Failed to sign out.");
                if(pageLoadingElement) pageLoadingElement.classList.add('hidden');
            }
        }
    }


    // --- WeConnect Platform Tools (Kept as example, adapt or remove) ---
    const weConnectToolsData = [ /* ... same as original ... */
        { id: 'weconnect-ai-text-editor', name: 'AI Text Editor (Platform)', description: 'Enhance writing with AI grammar checks & style suggestions.', icon: 'fas fa-edit', trending: true },
        { id: 'weconnect-ai-image-generator', name: 'AI Image Generator (Platform)', description: 'Create unique images from text prompts using AI models.', icon: 'fas fa-image', trending: true },
        { id: 'weconnect-ai-video-generator', name: 'AI Video Generator (Platform)', description: 'Produce videos from scripts with AI voiceovers & visuals.', icon: 'fas fa-video' },
        { id: 'weconnect-voice-cloner', name: 'Voice Cloner (Platform)', description: 'Clone voices for narrations and content creation.', icon: 'fas fa-microphone-alt' },
        { id: 'weconnect-chat-with-ai', name: 'Chat with AI (Platform)', description: 'Intelligent conversations, get answers, brainstorm ideas.', icon: 'fas fa-comments' },
        { id: 'weconnect-translator', name: 'Translator (Platform)', description: 'Translate text between languages with high accuracy.', icon: 'fas fa-globe-americas', trending: true }
    ];
    function renderWeConnectToolCard(tool) { /* ... same as original ... */ 
        const card = document.createElement('div');
        card.classList.add('weconnect-tool-card');
        let trendingTagHtml = tool.trending ? '<span class="trending-tag">Trending</span>' : '';
        card.innerHTML = `${trendingTagHtml}<div class="weconnect-tool-card-header"><i class="${tool.icon || 'fas fa-tools'}"></i><h3>${tool.name}</h3></div><p>${tool.description}</p><a href="#" class="btn-launch">Launch</a>`;
        // Add click listener to launch tool or navigate
        card.querySelector('.btn-launch').addEventListener('click', (e) => {
            e.preventDefault();
            alert(`Launching platform tool: ${tool.name} (Navigation TBD)`);
            // Example: window.location.href = `platform-tools/${tool.id}.html`;
        });
        return card;
    }
    function displayWeConnectTools(tools) { /* ... same as original ... */ 
        if (!weConnectToolGrid) return;
        weConnectToolGrid.innerHTML = ''; 
        tools.forEach(tool => weConnectToolGrid.appendChild(renderWeConnectToolCard(tool)));
    }
    async function loadAndDisplayWeConnectTools() { /* ... same as original ... */ 
        const fetchedTools = weConnectToolsData; // Using static data for now
        if (weConnectToolGrid && fetchedTools && fetchedTools.length > 0) displayWeConnectTools(fetchedTools);
        else if(weConnectToolGrid) weConnectToolGrid.innerHTML = '<p style="text-align:center; color:var(--aiConnect-text-secondary);">No platform tools available.</p>';
    }


    // --- AI Creator Suite Tool Definitions and Logic (Llama Vision tools REMOVED) ---
    // Utility functions for AI tools (showSpinner, hideSpinner, displayOutput, displayError) - same as original
    function showSpinner(spinnerId) { const s = currentAiToolWrapper.querySelector(`#${spinnerId}`); if(s)s.style.display='block';}
    function hideSpinner(spinnerId) { const s = currentAiToolWrapper.querySelector(`#${spinnerId}`); if(s)s.style.display='none';}
    function displayOutput(outputId, data, isHtml=false){const o=currentAiToolWrapper.querySelector(`#${outputId}`);if(o){if(isHtml)o.innerHTML=data;else o.textContent=data;o.style.color='';}}
    function displayError(outputId, error){const o=currentAiToolWrapper.querySelector(`#${outputId}`);if(o){o.textContent=`Error: ${error.message||error}`;o.style.color='var(--aiConnect-error)';}}

    // API Call functions (callLlama3, callFluxImageGeneration, callDeepgramSTT, callDeepgramTTS, callDeepgramRead)
    // Ensure these use the TOGETHER_API_KEY and DEEPGRAM_API_KEY defined at the top.
    // These functions remain mostly the same, just ensure correct API key usage and error display.
    async function callLlama3(promptContent, spinnerId, outputId) { /* ... same as original, check API key usage ... */ 
        if (!TOGETHER_API_KEY || TOGETHER_API_KEY.includes("YOUR_")) { displayError(outputId, "Together API Key not configured."); return; }
        showSpinner(spinnerId); displayOutput(outputId, ''); 
        try {
            const response = await fetch("https://api.together.xyz/v1/chat/completions", {
                method: "POST", headers: { "Authorization": `Bearer ${TOGETHER_API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({ model: "meta-llama/Llama-3.1-70B-Instruct-Turbo-Free", messages: [{ role: "user", content: promptContent }], max_tokens: 512, temperature: 0.7}) // Updated Llama 3 model
            });
            if (!response.ok) { const errData = await response.json(); throw new Error(`API Error (${response.status}): ${errData.error?.message || 'Unknown error'}`); }
            const data = await response.json();
            const resultText = data.choices?.[0]?.message?.content?.trim() || "No content received.";
            displayOutput(outputId, resultText);
        } catch (error) { console.error("Llama 3 API call failed:", error); displayError(outputId, error); } 
        finally { hideSpinner(spinnerId); }
    }
    async function callFluxImageGeneration(prompt, spinnerId, outputId) { /* ... same as original, check API key usage ... */ 
        if (!TOGETHER_API_KEY || TOGETHER_API_KEY.includes("YOUR_")) { displayError(outputId, "Together API Key not configured."); return; }
        showSpinner(spinnerId); const o=currentAiToolWrapper.querySelector(`#${outputId}`); if(o)o.innerHTML='';
        try {
            const response = await fetch("https://api.together.xyz/v1/images/generations", {
                method: "POST", headers: { "Authorization": `Bearer ${TOGETHER_API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({ model: "black-forest-labs/FLUX.1-schnell-Free", prompt: prompt, width: 512, height: 512, steps: 4, n: 1, response_format: "b64_json"})
            });
            if (!response.ok) { const errData = await response.json(); throw new Error(`API Error (${response.status}): ${errData.error?.message || 'Unknown error'}`); }
            const data = await response.json();
            if (data.data?.[0]?.b64_json && o) {
                const i=document.createElement('img'); i.src=`data:image/png;base64,${data.data[0].b64_json}`; i.alt=prompt;
                i.classList.add('mx-auto', 'my-2', 'rounded-md', 'border'); i.style.borderColor = 'var(--aiConnect-border)';
                o.appendChild(i);
            } else { displayOutput(outputId, "No image data received."); }
        } catch (error) { console.error("Image Generation API call failed:", error); displayError(outputId, error); } 
        finally { hideSpinner(spinnerId); }
    }
    async function callDeepgramSTT(audioFile, spinnerId, outputId) { /* ... same as original, check API key usage ... */ 
        if (!DEEPGRAM_API_KEY || DEEPGRAM_API_KEY.includes("YOUR_")) { displayError(outputId, "Deepgram API Key not configured."); return null; }
        showSpinner(spinnerId); displayOutput(outputId, '');
        try {
            const response = await fetch("https://api.deepgram.com/v1/listen?smart_format=true&punctuate=true¶graphs=true&model=nova-2", {
                method: "POST", headers: { "Authorization": `Token ${DEEPGRAM_API_KEY}` }, body: audioFile
            });
            if (!response.ok) { const errData = await response.json(); throw new Error(`API Error (${response.status}): ${errData.err_msg||errData.reason||'Unknown error'}`);}
            const data = await response.json();
            const transcript = data.results?.channels[0]?.alternatives[0]?.transcript || "No transcript found.";
            displayOutput(outputId, transcript); return transcript; 
        } catch (error) { console.error("Deepgram STT API call failed:", error); displayError(outputId, error); return null; } 
        finally { hideSpinner(spinnerId); }
    }
    async function callDeepgramTTS(text, spinnerId, outputId) { /* ... same as original, check API key usage ... */ 
        if (!DEEPGRAM_API_KEY || DEEPGRAM_API_KEY.includes("YOUR_")) { displayError(outputId, "Deepgram API Key not configured."); return; }
        showSpinner(spinnerId); const o=currentAiToolWrapper.querySelector(`#${outputId}`); if(o)o.innerHTML='';
        try {
            const response = await fetch("https://api.deepgram.com/v1/speak?model=aura-asteria-en", {
                method: "POST", headers: { "Authorization": `Token ${DEEPGRAM_API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({ text: text })
            });
            if (!response.ok) { 
                let msg='Unknown TTS error'; try{const d=await response.json();msg=d.err_msg||d.reason||JSON.stringify(d);}catch(e){msg=await response.text();}
                throw new Error(`API Error (${response.status}): ${msg}`);
            }
            const blob=await response.blob(); const url=URL.createObjectURL(blob); const a=document.createElement('audio');
            a.controls=true;a.src=url; if(o)o.appendChild(a);
        } catch (error) { console.error("Deepgram TTS API call failed:", error); displayError(outputId, error); } 
        finally { hideSpinner(spinnerId); }
    }
     async function callDeepgramRead(text, features, spinnerId, outputId) { /* ... same as original, check API key usage ... */ 
        if (!DEEPGRAM_API_KEY || DEEPGRAM_API_KEY.includes("YOUR_")) { displayError(outputId, "Deepgram API Key not configured."); return null; }
        showSpinner(spinnerId); displayOutput(outputId, '');
        let queryParams=Object.entries(features).map(([k,v])=>v===true?`${k==='summarize'?'summarize=v2':k+'=true'}&`:"").join('')+"language=en";
        try {
            const response = await fetch(`https://api.deepgram.com/v1/read?${queryParams}`, {
                method: "POST", headers: { "Authorization": `Token ${DEEPGRAM_API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({ text: text })
            });
            if(!response.ok){const d=await response.json();throw new Error(`API Error (${response.status}): ${d.err_msg||d.reason||'Unknown error'}`);}
            const data=await response.json(); displayOutput(outputId,JSON.stringify(data.results,null,2)); return data.results;
        } catch (error) { console.error("Deepgram Read API call failed:", error); displayError(outputId, error); return null; } 
        finally { hideSpinner(spinnerId); }
    }


    const aiCreatorToolsDefinitions = [ /* Llama Vision tools removed */
        { id: 'blogIdeaGenerator', title: 'Blog Idea Generator', icon: 'fas fa-lightbulb', html: () => `<h3>Blog Post Idea Generator</h3> <label for="blogTopic">Topic:</label><input type="text" id="blogTopic" placeholder="e.g., Sustainable Living"><button onclick="aiTool_generateBlogIdeas()">Generate Ideas</button><div class="spinner" id="blogIdeaSpinner"></div><div class="output" id="blogIdeaOutput"></div>`, action: async function aiTool_generateBlogIdeas(){ const t=currentAiToolWrapper.querySelector('#blogTopic').value;if(!t){alert("Topic?");return;} await callLlama3(`Generate 5 blog titles & concepts for topic: "${t}"`, 'blogIdeaSpinner','blogIdeaOutput'); }},
        { id: 'captionWriter', title: 'Social Media Caption Writer', icon: 'fas fa-share-square', html: () => `<h3>Social Media Caption Writer</h3><label for="captionTopic">Description:</label><input type="text" id="captionTopic" placeholder="e.g., New travel photo"><label for="captionPlatform">Platform:</label><select id="captionPlatform"><option>Instagram</option><option>Twitter (X)</option><option>LinkedIn</option><option>Facebook</option></select><button onclick="aiTool_generateCaptions()">Generate</button><div class="spinner" id="captionSpinner"></div><div class="output" id="captionOutput"></div>`, action: async function aiTool_generateCaptions(){ const t=currentAiToolWrapper.querySelector('#captionTopic').value; const p=currentAiToolWrapper.querySelector('#captionPlatform').value; if(!t){alert("Topic?");return;} await callLlama3(`3 social captions for ${p} on: "${t}". Include emojis & hashtags.`, 'captionSpinner','captionOutput'); }},
        { id: 'hookCreator', title: 'Video Script Hook Creator', icon: 'fas fa-film', html: () => `<h3>Video Script Hook Creator</h3><label for="hookTopic">Video topic:</label><input type="text" id="hookTopic" placeholder="e.g., 10 productivity hacks"><button onclick="aiTool_generateHooks()">Generate Hooks</button><div class="spinner" id="hookSpinner"></div><div class="output" id="hookOutput"></div>`, action: async function aiTool_generateHooks(){const t=currentAiToolWrapper.querySelector('#hookTopic').value;if(!t){alert("Topic?");return;} await callLlama3(`5 opening hooks for video about "${t}"`, 'hookSpinner','hookOutput');}},
        { id: 'promptEnhancer', title: 'Image Prompt Enhancer', icon: 'fas fa-magic', html: () => `<h3>Image Prompt Enhancer</h3><label for="simplePrompt">Simple prompt:</label><input type="text" id="simplePrompt" placeholder="e.g., cat on a roof"><button onclick="aiTool_enhancePrompt()">Enhance</button><div class="spinner" id="promptEnhancerSpinner"></div><div class="output" id="promptEnhancerOutput"></div>`, action: async function aiTool_enhancePrompt(){const p=currentAiToolWrapper.querySelector('#simplePrompt').value;if(!p){alert("Prompt?");return;} await callLlama3(`Enhance image prompt: "${p}". Add details: style, lighting, mood. 3 variations.`, 'promptEnhancerSpinner','promptEnhancerOutput');}},
        { id: 'imageGenerator', title: 'Simple Image Generator', icon: 'far fa-image', html: () => `<h3>Simple Image Generator</h3><label for="imageGenPrompt">Prompt:</label><input type="text" id="imageGenPrompt" placeholder="e.g., Futuristic cityscape sunset"><button onclick="aiTool_generateImage()">Generate Image</button><div class="spinner" id="imageGeneratorSpinner"></div><div class="output" id="imageGeneratorOutput"></div>`, action: async function aiTool_generateImage(){const p=currentAiToolWrapper.querySelector('#imageGenPrompt').value;if(!p){alert("Prompt?");return;} await callFluxImageGeneration(p, 'imageGeneratorSpinner','imageGeneratorOutput');}},
        { id: 'podcastTitleSuggester', title: 'Podcast Title Suggester', icon: 'fas fa-podcast', html: () => `<h3>Podcast Title Suggester</h3><label for="podcastTopic">Topic/Summary:</label><input type="text" id="podcastTopic" placeholder="e.g., Interview with tech innovator"><button onclick="aiTool_suggestPodcastTitles()">Suggest Titles</button><div class="spinner" id="podcastTitleSpinner"></div><div class="output" id="podcastTitleOutput"></div>`, action: async function aiTool_suggestPodcastTitles(){const t=currentAiToolWrapper.querySelector('#podcastTopic').value;if(!t){alert("Topic?");return;} await callLlama3(`5 podcast titles for show about: "${t}"`, 'podcastTitleSpinner','podcastTitleOutput');}},
        { id: 'emailSubjectGenerator', title: 'Email Subject Generator', icon: 'fas fa-envelope-open-text', html: () => `<h3>Email Subject Generator</h3><label for="emailContentSummary">Summary/Goal:</label><input type="text" id="emailContentSummary" placeholder="e.g., Announcing new product feature"><button onclick="aiTool_generateEmailSubjects()">Generate Subjects</button><div class="spinner" id="emailSubjectSpinner"></div><div class="output" id="emailSubjectOutput"></div>`, action: async function aiTool_generateEmailSubjects(){const s=currentAiToolWrapper.querySelector('#emailContentSummary').value;if(!s){alert("Summary?");return;} await callLlama3(`5 email subject lines for goal: "${s}"`, 'emailSubjectSpinner','emailSubjectOutput');}},
        { id: 'audioTranscriber', title: 'Audio Note Transcriber', icon: 'fas fa-file-audio', html: () => `<h3>Audio Note Transcriber</h3><label for="audioToTranscribe">Upload audio (WAV, MP3):</label><input type="file" id="audioToTranscribe" accept="audio/*"><button onclick="aiTool_transcribeAudio()">Transcribe</button><div class="spinner" id="audioTranscriberSpinner"></div><div class="output" id="audioTranscriberOutput"></div>`, action: async function aiTool_transcribeAudio(){const f=currentAiToolWrapper.querySelector('#audioToTranscribe');if(!f.files.length){alert("File?");return;} await callDeepgramSTT(f.files[0],'audioTranscriberSpinner','audioTranscriberOutput');}},
        { id: 'ttsAnnouncer', title: 'Text-to-Speech Announcer', icon: 'fas fa-bullhorn', html: () => `<h3>Text-to-Speech Announcer</h3><label for="textToSpeak">Text to speak:</label><textarea id="textToSpeak" rows="3" placeholder="Hello world."></textarea><button onclick="aiTool_speakText()">Speak Text</button><div class="spinner" id="ttsAnnouncerSpinner"></div><div class="output" id="ttsAnnouncerOutput"></div>`, action: async function aiTool_speakText(){const t=currentAiToolWrapper.querySelector('#textToSpeak').value;if(!t){alert("Text?");return;} await callDeepgramTTS(t,'ttsAnnouncerSpinner','ttsAnnouncerOutput');}},
        { id: 'sceneSummarizer', title: 'Video Script Scene Summarizer', icon: 'fas fa-align-left', html: () => `<h3>Video Script Scene Summarizer</h3><label for="scriptScene">Paste script scene:</label><textarea id="scriptScene" rows="5" placeholder="INT. COFFEE SHOP - DAY..."></textarea><button onclick="aiTool_summarizeScene()">Summarize</button><div class="spinner" id="sceneSummarizerSpinner"></div><div class="output" id="sceneSummarizerOutput"></div>`, action: async function aiTool_summarizeScene(){const s=currentAiToolWrapper.querySelector('#scriptScene').value;if(!s){alert("Scene?");return;} await callLlama3(`Summarize video script scene (1-2 sentences):\n\n${s}`, 'sceneSummarizerSpinner','sceneSummarizerOutput');}},
        { id: 'audioSentimentChecker', title: 'Audio Sentiment Checker', icon: 'fas fa-smile-beam', html: () => `<h3>Audio Sentiment Checker</h3><label for="audioForSentiment">Upload audio:</label><input type="file" id="audioForSentiment" accept="audio/*"><button onclick="aiTool_checkAudioSentiment()">Check Sentiment</button><div class="spinner" id="audioSentimentSpinner"></div><div class="output" id="audioSentimentOutput"></div>`, action: async function aiTool_checkAudioSentiment(){const f=currentAiToolWrapper.querySelector('#audioForSentiment');if(!f.files.length){alert("File?");return;}const tr=await callDeepgramSTT(f.files[0],'audioSentimentSpinner','audioSentimentOutput');if(tr)await callDeepgramRead(tr,{sentiment:true},'audioSentimentSpinner','audioSentimentOutput');else hideSpinner('audioSentimentSpinner');}},
        { id: 'audioTopicExtractor', title: 'Key Topics from Audio', icon: 'fas fa-tags', html: () => `<h3>Key Topics from Audio</h3><label for="audioForTopics">Upload audio:</label><input type="file" id="audioForTopics" accept="audio/*"><button onclick="aiTool_extractAudioTopics()">Extract Topics</button><div class="spinner" id="audioTopicSpinner"></div><div class="output" id="audioTopicOutput"></div>`, action: async function aiTool_extractAudioTopics(){const f=currentAiToolWrapper.querySelector('#audioForTopics');if(!f.files.length){alert("File?");return;}const tr=await callDeepgramSTT(f.files[0],'audioTopicSpinner','audioTopicOutput');if(tr)await callDeepgramRead(tr,{topics:true},'audioTopicSpinner','audioTopicOutput');else hideSpinner('audioTopicSpinner');}},
        { id: 'paraphraser', title: 'Content Paraphraser', icon: 'fas fa-random', html: () => `<h3>Content Paraphraser</h3><label for="textToParaphrase">Text to paraphrase:</label><textarea id="textToParaphrase" rows="5"></textarea><button onclick="aiTool_paraphraseText()">Paraphrase</button><div class="spinner" id="paraphraserSpinner"></div><div class="output" id="paraphraserOutput"></div>`, action: async function aiTool_paraphraseText(){const t=currentAiToolWrapper.querySelector('#textToParaphrase').value;if(!t){alert("Text?");return;} await callLlama3(`Paraphrase this:\n\n${t}`, 'paraphraserSpinner','paraphraserOutput');}},
        { id: 'textSummarizer', title: 'Text Summarizer', icon: 'fas fa-compress-arrows-alt', html: () => `<h3>Text Summarizer</h3><label for="textToSummarize">Text to summarize:</label><textarea id="textToSummarize" rows="7"></textarea><button onclick="aiTool_summarizeShortText()">Summarize</button><div class="spinner" id="textSummarizerSpinner"></div><div class="output" id="textSummarizerOutput"></div>`, action: async function aiTool_summarizeShortText(){const t=currentAiToolWrapper.querySelector('#textToSummarize').value;if(!t){alert("Text?");return;} await callLlama3(`Summarize concisely (2-3 sentences):\n\n${t}`, 'textSummarizerSpinner','textSummarizerOutput');}},
        { id: 'grammarToneChecker', title: 'Grammar & Tone Check', icon: 'fas fa-spell-check', html: () => `<h3>Grammar & Tone Check</h3><label for="textForGrammarTone">Text to check:</label><textarea id="textForGrammarTone" rows="5"></textarea><button onclick="aiTool_checkGrammarTone()">Check Text</button><div class="spinner" id="grammarToneSpinner"></div><div class="output" id="grammarToneOutput"></div>`, action: async function aiTool_checkGrammarTone(){const t=currentAiToolWrapper.querySelector('#textForGrammarTone').value;if(!t){alert("Text?");return;} await callLlama3(`Check grammar and assess tone:\n\n"${t}"`, 'grammarToneSpinner','grammarToneOutput');}},
        { id: 'keywordExtractor', title: 'Keyword Extractor', icon: 'fas fa-key', html: () => `<h3>Keyword Extractor</h3><label for="textForKeywords">Text to extract keywords:</label><textarea id="textForKeywords" rows="5"></textarea><button onclick="aiTool_extractKeywords()">Extract Keywords</button><div class="spinner" id="keywordExtractorSpinner"></div><div class="output" id="keywordExtractorOutput"></div>`, action: async function aiTool_extractKeywords(){const t=currentAiToolWrapper.querySelector('#textForKeywords').value;if(!t){alert("Text?");return;} await callLlama3(`Extract up to 10 main keywords/phrases:\n\n${t}`, 'keywordExtractorSpinner','keywordExtractorOutput');}},
        { id: 'readabilityEstimator', title: 'Readability Estimator', icon: 'fas fa-glasses', html: () => `<h3>Readability Estimator</h3><label for="textForReadability">Text to estimate readability:</label><textarea id="textForReadability" rows="5"></textarea><button onclick="aiTool_estimateReadability()">Estimate</button><div class="spinner" id="readabilitySpinner"></div><div class="output" id="readabilityOutput"></div>`, action: async function aiTool_estimateReadability(){const t=currentAiToolWrapper.querySelector('#textForReadability').value;if(!t){alert("Text?");return;} await callLlama3(`Estimate Flesch-Kincaid Grade Level and give qualitative assessment:\n\n"${t}"`, 'readabilitySpinner','readabilityOutput');}},
        { id: 'textSentimentChecker', title: 'Text Sentiment Checker', icon: 'far fa-grin-stars', html: () => `<h3>Text Sentiment Checker</h3><label for="textForSentiment">Text snippet:</label><input type="text" id="textForSentiment" placeholder="e.g., I love this product!"><button onclick="aiTool_checkTextSentiment()">Check</button><div class="spinner" id="textSentimentSpinner"></div><div class="output" id="textSentimentOutput"></div>`, action: async function aiTool_checkTextSentiment(){const t=currentAiToolWrapper.querySelector('#textForSentiment').value;if(!t){alert("Text?");return;} await callDeepgramRead(t,{sentiment:true},'textSentimentSpinner','textSentimentOutput');}},
        { id: 'tweetFromBlog', title: 'Tweet Snippet Creator', icon: 'fab fa-twitter', html: () => `<h3>Tweet Snippet Creator</h3><label for="blogParagraphForTweet">Blog paragraph:</label><textarea id="blogParagraphForTweet" rows="5"></textarea><button onclick="aiTool_generateTweetsFromParagraph()">Generate Tweets</button><div class="spinner" id="tweetFromBlogSpinner"></div><div class="output" id="tweetFromBlogOutput"></div>`, action: async function aiTool_generateTweetsFromParagraph(){const p=currentAiToolWrapper.querySelector('#blogParagraphForTweet').value;if(!p){alert("Paragraph?");return;} await callLlama3(`Generate 2-3 tweet options (under 280 chars each) with hashtags from:\n\n"${p}"`, 'tweetFromBlogSpinner','tweetFromBlogOutput');}},
        { id: 'quoteFinder', title: 'Quote Finder from Text', icon: 'fas fa-quote-left', html: () => `<h3>Quote Finder</h3><label for="textForQuotes">Text to find quotes:</label><textarea id="textForQuotes" rows="7"></textarea><button onclick="aiTool_findQuotes()">Find Quotes</button><div class="spinner" id="quoteFinderSpinner"></div><div class="output" id="quoteFinderOutput"></div>`, action: async function aiTool_findQuotes(){const t=currentAiToolWrapper.querySelector('#textForQuotes').value;if(!t){alert("Text?");return;} await callLlama3(`Extract 3-5 impactful or quotable sentences:\n\n${t}`, 'quoteFinderSpinner','quoteFinderOutput');}},
        { id: 'faqGenerator', title: 'FAQ Generator', icon: 'fas fa-question-circle', html: () => `<h3>FAQ Generator</h3><label for="contentForFaqs">Content to generate FAQs from:</label><textarea id="contentForFaqs" rows="7"></textarea><button onclick="aiTool_generateFaqs()">Generate FAQs</button><div class="spinner" id="faqGeneratorSpinner"></div><div class="output" id="faqGeneratorOutput"></div>`, action: async function aiTool_generateFaqs(){const c=currentAiToolWrapper.querySelector('#contentForFaqs').value;if(!c){alert("Content?");return;} await callLlama3(`Generate 3-5 FAQs with answers based on:\n\n${c}`, 'faqGeneratorSpinner','faqGeneratorOutput');}},
        { id: 'eli5Simplifier', title: 'ELI5 Text Simplifier', icon: 'fas fa-child', html: () => `<h3>ELI5 Text Simplifier</h3><label for="textToSimplify">Complex text:</label><textarea id="textToSimplify" rows="5"></textarea><button onclick="aiTool_simplifyEli5()">Simplify (ELI5)</button><div class="spinner" id="eli5Spinner"></div><div class="output" id="eli5Output"></div>`, action: async function aiTool_simplifyEli5(){const t=currentAiToolWrapper.querySelector('#textToSimplify').value;if(!t){alert("Text?");return;} await callLlama3(`Explain like I'm 5:\n\n"${t}"`, 'eli5Spinner','eli5Output');}},
        { id: 'featureToBenefit', title: 'Feature to Benefit Converter', icon: 'fas fa-exchange-alt', html: () => `<h3>Feature to Benefit</h3><label for="productFeatures">Product features (one per line):</label><textarea id="productFeatures" rows="5"></textarea><button onclick="aiTool_convertToBenefits()">Convert</button><div class="spinner" id="featureToBenefitSpinner"></div><div class="output" id="featureToBenefitOutput"></div>`, action: async function aiTool_convertToBenefits(){const f=currentAiToolWrapper.querySelector('#productFeatures').value;if(!f){alert("Features?");return;} await callLlama3(`Convert features to benefits:\n\n${f}\n\nFormat: Feature: [F]\nBenefit: [B]`, 'featureToBenefitSpinner','featureToBenefitOutput');}},
        { id: 'ctaGenerator', title: 'Call-to-Action Generator', icon: 'fas fa-mouse-pointer', html: () => `<h3>Call-to-Action Generator</h3><label for="ctaContext">Content/Goal for CTA:</label><input type="text" id="ctaContext"><button onclick="aiTool_generateCtas()">Generate CTAs</button><div class="spinner" id="ctaGeneratorSpinner"></div><div class="output" id="ctaGeneratorOutput"></div>`, action: async function aiTool_generateCtas(){const c=currentAiToolWrapper.querySelector('#ctaContext').value;if(!c){alert("Context?");return;} await callLlama3(`Generate 3-5 compelling CTAs for: "${c}"`, 'ctaGeneratorSpinner','ctaGeneratorOutput');}},
        { id: 'hashtagGenerator', title: 'Hashtag Generator (Text Only)', icon: 'fas fa-hashtag', html: () => `<h3>Hashtag Generator</h3><label for="hashtagInputText">Enter text for hashtags:</label><input type="text" id="hashtagInputText" placeholder="e.g., My latest travel adventure"><button onclick="aiTool_generateHashtagsTextOnly()">Generate Hashtags</button><div class="spinner" id="hashtagSpinner"></div><div class="output" id="hashtagOutput"></div>`, action: async function aiTool_generateHashtagsTextOnly(){const t=currentAiToolWrapper.querySelector('#hashtagInputText').value;if(!t){alert("Text?");return;} await callLlama3(`Generate 10-15 relevant hashtags for: "${t}"`, 'hashtagSpinner','hashtagOutput');}},
        { id: 'pollQuestionGenerator', title: 'Poll/Quiz Question Generator', icon: 'fas fa-poll', html: () => `<h3>Poll/Quiz Question Generator</h3><label for="pollTopic">Topic:</label><input type="text" id="pollTopic"><label for="pollType">Type:</label><select id="pollType"><option value="poll">Poll</option><option value="quiz">Quiz</option></select><button onclick="aiTool_generatePollQuestion()">Generate</button><div class="spinner" id="pollQuestionSpinner"></div><div class="output" id="pollQuestionOutput"></div>`, action: async function aiTool_generatePollQuestion(){const t=currentAiToolWrapper.querySelector('#pollTopic').value;const y=currentAiToolWrapper.querySelector('#pollType').value;if(!t){alert("Topic?");return;}let p="";if(y==="poll")p=`Poll question for "${t}" with 3-4 options.`;else p=`Quiz question for "${t}" with 3-4 options & correct answer.`;await callLlama3(p,'pollQuestionSpinner','pollQuestionOutput');}}
    ];
    
    // Populate AI Creator Suite Nav and make actions global
    aiCreatorToolsDefinitions.forEach(toolDef => {
        if (toolDef.action && typeof toolDef.action === 'function') {
            window[toolDef.action.name] = toolDef.action; // Make action function global
        }
    });

    function populateAiCreatorSuiteNav() {
        const navContainer = document.getElementById('aiCreatorSuiteNavLinks');
        if (!navContainer) return;
        navContainer.innerHTML = ''; 
        const ul = document.createElement('ul');
        aiCreatorToolsDefinitions.forEach(tool => {
            const li = document.createElement('li');
            li.innerHTML = `<a href="#" class="ai-tool-nav-link main-nav-link" data-tool-id="${tool.id}"><i class="${tool.icon || 'fas fa-cogs'}"></i><span>${tool.title}</span></a>`;
            ul.appendChild(li);
        });
        navContainer.appendChild(ul);
    }

    function activateAiTool(toolId) {
        const toolDefinition = aiCreatorToolsDefinitions.find(t => t.id === toolId);
        if (!toolDefinition) { console.error("AI Tool definition not found:", toolId); return; }

        if (appTitleTopbar) appTitleTopbar.textContent = toolDefinition.title; // Update topbar title
        if(mainContentHeader) mainContentHeader.style.display = 'none'; // Hide default dashboard header
        if(weConnectToolGrid) weConnectToolGrid.style.display = 'none';
        if(walletCard) walletCard.style.display = 'none'; 
        if(aiToolContentContainer) aiToolContentContainer.style.display = 'block';
        
        const isApiKeyPlaceholder = (key) => !key || key.includes("YOUR_") || key === "3b1c02603a0137c8c8b265ef1ed02c3e448c089a44f052ca6acf54210fa6b34c" || key === "7fafa4b6f51e5c61a4b4d3895654178ee8602f7e"; // Add actual placeholder values
        if (isApiKeyPlaceholder(TOGETHER_API_KEY) || ( (toolId.toLowerCase().includes('audio') || toolId.toLowerCase().includes('sentiment') || toolId.toLowerCase().includes('topics')) && isApiKeyPlaceholder(DEEPGRAM_API_KEY) )) {
             if(apiKeyNotice) apiKeyNotice.style.display = 'block';
        } else {
             if(apiKeyNotice) apiKeyNotice.style.display = 'none';
        }

        if(currentAiToolWrapper && typeof toolDefinition.html === 'function') {
            // Clear previous tool content & event listeners if any complex ones were added
            currentAiToolWrapper.innerHTML = toolDefinition.html();
            // Re-attach any general listeners or call tool-specific setup if needed
        }
        document.querySelectorAll('.sidebar-nav a').forEach(l => l.classList.remove('active'));
        const activeLink = document.querySelector(`.sidebar-nav a[data-tool-id="${toolId}"], .sidebar-nav a[data-section="${toolId}"]`);
        if (activeLink) activeLink.classList.add('active');
        if (window.innerWidth <= 767 && sidebar && sidebar.classList.contains('open')) sidebar.classList.remove('open');
    }
    
    function showDashboardContent() {
        if (appTitleTopbar) appTitleTopbar.textContent = "Dashboard"; // Reset topbar title
        if(mainContentHeader) mainContentHeader.style.display = 'block'; // Show dashboard header
        if(aiToolContentContainer) aiToolContentContainer.style.display = 'none';
        if(apiKeyNotice) apiKeyNotice.style.display = 'none';
        if(weConnectToolGrid) weConnectToolGrid.style.display = 'grid'; 
        if(walletCard) walletCard.style.display = 'block';
        loadAndDisplayWeConnectTools(); // Reload platform tools for dashboard
    }

    document.addEventListener('DOMContentLoaded', () => {
        console.log('ai-Connect App Initializing...');
        applyAiConnectTheme(); 
        // setInitialSidebarState(); // This might conflict if sidebar should start closed on mobile
        if (sidebar && window.innerWidth > 767) { // Default to collapsed on desktop, closed on mobile
             sidebar.classList.add('collapsed');
        }

        populateAiCreatorSuiteNav(); 
        showDashboardContent(); // Show dashboard by default

        document.querySelectorAll('.sidebar-nav a.main-nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelectorAll('.sidebar-nav a.main-nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                const toolId = this.dataset.toolId; 
                const sectionId = this.dataset.section; 

                if (toolId) activateAiTool(toolId);
                else if (sectionId) { 
                    if (sectionId === 'dashboard' || sectionId === 'all-weconnect-tools') {
                        showDashboardContent();
                    } else if (sectionId === 'profile') {
                        window.location.href = 'aiconnect-userprofile.html';
                    } else if (sectionId === 'settings') {
                        window.location.href = 'aiconnect-settings.html';
                    } else if (sectionId === 'support') {
                        window.location.href = 'aiconnect-support.html';
                    } else { // For sections like Favorites if added later
                        if (appTitleTopbar) appTitleTopbar.textContent = this.querySelector('span')?.textContent || 'Section';
                        if(aiToolContentContainer) aiToolContentContainer.style.display = 'none';
                        if(apiKeyNotice) apiKeyNotice.style.display = 'none';
                        if(weConnectToolGrid) weConnectToolGrid.innerHTML = `<p style="text-align:center; color:var(--aiConnect-text-secondary);">Content for ${this.querySelector('span')?.textContent || sectionId} will load here.</p>`;
                        if(walletCard) walletCard.style.display = 'block'; // Keep wallet visible or hide as per design
                    }
                    if (window.innerWidth <= 767 && sidebar && sidebar.classList.contains('open')) {
                        sidebar.classList.remove('open');
                    }
                }
            });
        });
        
        const initialDashboardLink = document.querySelector('.sidebar-nav a[data-section="dashboard"]');
        if(initialDashboardLink) initialDashboardLink.classList.add('active');

        setTimeout(() => { // Fallback loader hide
            if(pageLoadingElement && !pageLoadingElement.classList.contains('hidden')) pageLoadingElement.classList.add('hidden');
        }, 1500); // Shortened as auth check hides it too
    });
</script>

</body>
</html>